!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var s in i)("object"==typeof exports?exports:e)[s]=i[s]}}(self,()=>(()=>{"use strict";var e,t,i,s,n={d:(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};n.r(r),n.d(r,{GwCrossOriginExternal:()=>o}),function(e){e[e.SET_VALUES=0]="SET_VALUES",e[e.GET_VALUES=1]="GET_VALUES",e[e.FIRE_ACTION=2]="FIRE_ACTION",e[e.NON_BLOCKING_SERVER_REQUEST=3]="NON_BLOCKING_SERVER_REQUEST",e[e.BROADCAST_CROSS_ORIGIN_EVENT=4]="BROADCAST_CROSS_ORIGIN_EVENT",e[e.ADD_CROSS_ORIGIN_EVENT_LISTENER=5]="ADD_CROSS_ORIGIN_EVENT_LISTENER",e[e.REMOVE_CROSS_ORIGIN_EVENT_LISTENER=6]="REMOVE_CROSS_ORIGIN_EVENT_LISTENER"}(e||(e={})),function(e){e[e.VALUES=0]="VALUES",e[e.RESPONSE_FROM_NON_BLOCKING_SERVER_REQUEST=1]="RESPONSE_FROM_NON_BLOCKING_SERVER_REQUEST",e[e.CONFIRMATION_ONLY=2]="CONFIRMATION_ONLY",e[e.RECEIVE_CROSS_ORIGIN_EVENT=3]="RECEIVE_CROSS_ORIGIN_EVENT",e[e.RECEIVE_GW_NOTIFICATION=4]="RECEIVE_GW_NOTIFICATION"}(t||(t={})),function(e){e[e.LOCALE_CHANGED=0]="LOCALE_CHANGED",e[e.THEME_CHANGED=1]="THEME_CHANGED",e[e.GENERAL=2]="GENERAL"}(i||(i={})),function(e){e[e.SUCCEEDED=0]="SUCCEEDED",e[e.WARNING=1]="WARNING",e[e.FAILED=2]="FAILED",e[e.PENDING=3]="PENDING",e[e.NONE=4]="NONE"}(s||(s={}));class o{static nextMessageId=1e3;static initialized=!1;static originForGwApp;static messagesAwaitingResponse={};static crossOriginEventCallbackByBroadcasterThenEvent={};static gwNotificationListeners={};static allowListedDomains={};static ownerWindow;static messageEventListener;constructor(){throw new Error("Static class. Use GwCrossOriginExternal.init()")}static init(e,t,i){this.ownerWindow=i||window.parent,this.allowListedDomains=t,this.originForGwApp=e,this.initialized=!0,this.messageEventListener=this.receiveMessageFromGwApp.bind(this),window.addEventListener("message",this.messageEventListener,!1)}static isInitialized(){return this.initialized}static kill(){this.initialized=!1,this.originForGwApp=void 0,this.messageEventListener&&(this.ownerWindow.removeEventListener("message",this.messageEventListener,!1),this.messageEventListener=void 0)}static throwIfUntrustedOrigin(e){if(this.ownerWindow!==e.source||this.originForGwApp!==e.origin)throw new Error("Received untrusted message from origin: "+e.origin);if(e.data.gwNonGwOriginIfAny&&"*"!==this.allowListedDomains&&!this.allowListedDomains[e.data.gwNonGwOriginIfAny])throw new Error("Received message from trusted GW Application origin, but from an originating origin not on the allow list.")}static receiveMessageFromGwApp(e){if(!this.initialized)return;this.throwIfUntrustedOrigin(e);const i=e.data;switch(i.gwMessageType){case t.VALUES:this.receiveValuesMessage(i);break;case t.RESPONSE_FROM_NON_BLOCKING_SERVER_REQUEST:this.receiveNonBlockingServerRequestReponseMessage(i);break;case t.CONFIRMATION_ONLY:this.receiveConfirmationOnlyMessage(i);break;case t.RECEIVE_CROSS_ORIGIN_EVENT:this.receiveCrossOriginEvent(i);break;case t.RECEIVE_GW_NOTIFICATION:this.receiveGwNotification(i);break;default:this.receiveNonConformingMessageTypeFromGwApp(e)}}static getAwaitingInfoForCorrespondingMessageData(e){const t=e.gwResponseToMessageId;if(!t&&0!==t)return console.error("Received values payload with no responseToMessageId identifier: ",e),null;const i=this.messagesAwaitingResponse[t];return window.GwTestEnv?i:i||(console.error("Received values payload with a responseToMessageId: "+t+". But could not locate a corresponding Promise. Data: ",e),null)}static receiveMessage(e){const t=e.gwPayload,i=e.gwStatus,n=this.getAwaitingInfoForCorrespondingMessageData(e);if(!n)return;const r=i===s.FAILED?n.reject:n.fulfill;r&&r(t)}static receiveNonBlockingServerRequestReponseMessage(e){this.receiveMessage(e)}static receiveValuesMessage(e){this.receiveMessage(e)}static receiveConfirmationOnlyMessage(e){this.receiveMessage(e)}static receiveCrossOriginEvent(e){const t=e.gwPayload,i=this.crossOriginEventCallbackByBroadcasterThenEvent[t.broadcasterWindowId];if(!i)return void console.warn("Received cross origin event from a broadcast window not currently being listened to.");const s=i[t.eventName]||i["*"];s||console.warn("Received cross origin event for an event type without a registered callback: "+t.broadcasterWindowId+":"+t.eventName),s(t)}static receiveGwNotification(e){const t=e.gwPayload,i=this.gwNotificationListeners[t.type];i&&i(t)}static receiveNonConformingMessageTypeFromGwApp(e){const t=this[e.data.gwMessageType];"function"!=typeof t?console.warn("--- Received MessageEvent from GwApp without a gwMessageType that matched a method on GwCrossOriginExternal.\n--- This is likely an Error.\n--- However, receiveNonConformingMessageTypeFromGwApp can be overridden in GwCrossOriginExternal.\n--- This allows custom logic based on any MessageEvent that does not implement GwMessageEvent. But consider MessageType.FIRE_CUSTOM_EVENT instead."):this[t](e)}static sendMessage(e,t,i=null){if(!this.ownerWindow)return Promise.reject(new Error("Attempting to send a message to a null GwApp window. Ensure that this window was spawned by a Guidwire Application."));const n=this.nextMessageId++,r={gwMessageType:e,gwPayload:t,gwStatus:s.PENDING,gwMessageId:n,gwResponseToMessageId:i},o={messageId:n,timestamp:window.performance.now()};this.messagesAwaitingResponse[n]=o;try{const e=new Promise((e,t)=>{o.fulfill=e,o.reject=t});return this.ownerWindow.postMessage(r,this.originForGwApp),e}catch(e){return Promise.reject(e)}}static setValues(t){return this.sendMessage(e.SET_VALUES,t)}static getValues(t){return this.sendMessage(e.GET_VALUES,t)}static fireActionOnServer(t){return this.sendMessage(e.FIRE_ACTION,t)}static makeNonBlockingServerRequest(t){return this.sendMessage(e.NON_BLOCKING_SERVER_REQUEST,t)}static addCrossOriginEventListener(t,i,s){let n=this.crossOriginEventCallbackByBroadcasterThenEvent[t]=this.crossOriginEventCallbackByBroadcasterThenEvent[t]||{};return n["*"]?Promise.reject(new Error("There is already an 'all' listener (`*`) for this broadcaster. Remove it before adding any other listeners: "+t+":"+i)):n[i]?Promise.reject(new Error("Cannot register multiple callbacks for the same broadcaster and event: "+t+":"+i)):("*"===i&&Object.keys(n).length>0&&(console.warn("Adding an 'all' listener of '*' to a broadcaster that already has more specific listener. All specific listeners will be removed. In order to avoid this warning, remove known listeners manually before adding."),n=this.crossOriginEventCallbackByBroadcasterThenEvent[t]={}),n[i]=s,this.sendMessage(e.ADD_CROSS_ORIGIN_EVENT_LISTENER,{broadcasterWindowName:t,eventName:i}))}static removeCrossOriginEventListener(t,i){const s=this.crossOriginEventCallbackByBroadcasterThenEvent[t];return s&&("*"===i?delete this.crossOriginEventCallbackByBroadcasterThenEvent[t]:delete s[i]),this.sendMessage(e.REMOVE_CROSS_ORIGIN_EVENT_LISTENER,{broadcasterWindowName:t,eventName:i})}static broadcastCrossOriginEvent(t,i){return 0===t.length||"*"===t?Promise.reject(new Error("Illegal eventName passed to fireCrossOriginEvent. Cannot be empty or the single `*` character: "+t)):this.sendMessage(e.BROADCAST_CROSS_ORIGIN_EVENT,{eventName:t,info:i})}static addCallbackForGwNotificationType(e,t){if(this.gwNotificationListeners[e])throw new Error("Attempting to load multiple callbacks for notification type: "+e+". call removeCallbackBackForGWNotificationType first.");if(this.gwNotificationListeners["*"])throw new Error("Attempting to load a notification listener when their is already a * listener. New listener: "+e);this.gwNotificationListeners[e]=t}static removeCallbackForGwNotificationType(e){this.gwNotificationListeners[e]||console.warn("Attempting to remove a non existent notification listener for: "+e),delete this.gwNotificationListeners[e]}}return r})());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUVQLHdCQUF1QjlCLGFBQ3RHLENBV0EsZ0NBQU9zQyxDQUEwQnRDLEVBQW1DbEIsR0FDbEUsT0FBeUIsSUFBckJrQixFQUFVaUMsUUFBOEIsTUFBZGpDLEVBQ3JCTyxRQUFRZixPQUNiLElBQUluRCxNQUFNLGtHQUFvRzJELElBSTNHdEQsS0FBSzJELFlBQVl0RixFQUFld0gsNkJBQThCLENBQUV2QyxZQUFXbEIsUUFDcEYsQ0FRQSx1Q0FBTzBELENBQWlDQyxFQUFzQ25ELEdBQzVFLEdBQUk1QyxLQUFLd0Qsd0JBQXdCdUMsR0FDL0IsTUFBTSxJQUFJcEcsTUFDUixnRUFDRW9HLEVBQ0EseURBRUMsR0FBSS9GLEtBQUt3RCx3QkFBd0IsS0FDdEMsTUFBTSxJQUFJN0QsTUFBTSxnR0FBa0dvRyxHQUVwSC9GLEtBQUt3RCx3QkFBd0J1QyxHQUFvQm5ELENBQ25ELENBUUEsMENBQU9vRCxDQUFvQ0QsR0FDcEMvRixLQUFLd0Qsd0JBQXdCdUMsSUFDaEM3RCxRQUFRa0IsS0FBSyxrRUFBb0UyQyxVQUU1RS9GLEtBQUt3RCx3QkFBd0J1QyxFQUN0QyxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vdHMvdHlwZXMvZ3dDcm9zc09yaWdpblR5cGVzLnRzIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vLy4vdHMvZW1iZWRkZWQvR3dDcm9zc09yaWdpbkV4dGVybmFsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSB7XG5cdFx0dmFyIGEgPSBmYWN0b3J5KCk7XG5cdFx0Zm9yKHZhciBpIGluIGEpICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgPyBleHBvcnRzIDogcm9vdClbaV0gPSBhW2ldO1xuXHR9XG59KShzZWxmLCAoKSA9PiB7XG5yZXR1cm4gIiwiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsImV4cG9ydCB0eXBlIEd3S2V5VmFsdWU8VD4gPSB7IFtrZXk6IHN0cmluZ106IFQgfTtcblxuLyoqXG4gKiBUeXBlcyB1c2VkIGJ5IGVtYmVkZGVkIHdpZGdldHMgd2hlbiBjb21tdW5pY2F0aW5nIHdpdGggSW5zdXJhbmNlU3VpdGUgdmlhIHRoZSBHd0Nyb3NzT3JpZ2luRXh0ZXJuYWwgQVBJXG4gKi9cbmV4cG9ydCBjb25zdCBlbnVtIEd3TWVzc2FnZXNUb0dXIHtcbiAgU0VUX1ZBTFVFUyxcbiAgR0VUX1ZBTFVFUyxcbiAgRklSRV9BQ1RJT04sXG4gIE5PTl9CTE9DS0lOR19TRVJWRVJfUkVRVUVTVCxcbiAgQlJPQURDQVNUX0NST1NTX09SSUdJTl9FVkVOVCxcbiAgQUREX0NST1NTX09SSUdJTl9FVkVOVF9MSVNURU5FUixcbiAgUkVNT1ZFX0NST1NTX09SSUdJTl9FVkVOVF9MSVNURU5FUlxufVxuXG5leHBvcnQgY29uc3QgZW51bSBHd01lc3NhZ2VzRnJvbUdXIHtcbiAgVkFMVUVTLFxuICBSRVNQT05TRV9GUk9NX05PTl9CTE9DS0lOR19TRVJWRVJfUkVRVUVTVCxcbiAgQ09ORklSTUFUSU9OX09OTFksXG4gIFJFQ0VJVkVfQ1JPU1NfT1JJR0lOX0VWRU5ULFxuICBSRUNFSVZFX0dXX05PVElGSUNBVElPTlxufVxuXG5leHBvcnQgY29uc3QgZW51bSBHd05vdGlmaWNhdGlvblR5cGUge1xuICBMT0NBTEVfQ0hBTkdFRCxcbiAgVEhFTUVfQ0hBTkdFRCxcbiAgR0VORVJBTFxufVxuXG5leHBvcnQgY29uc3QgZW51bSBHd01lc3NhZ2VTdGF0dXMge1xuICBTVUNDRUVERUQsXG4gIFdBUk5JTkcsXG4gIEZBSUxFRCxcbiAgUEVORElORyxcbiAgTk9ORVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEd3TWVzc2FnZURhdGEge1xuICBba2V5OiBzdHJpbmddOiBhbnk7XG5cbiAgZ3dNZXNzYWdlVHlwZTogR3dNZXNzYWdlc0Zyb21HVyB8IEd3TWVzc2FnZXNUb0dXO1xuICBnd1BheWxvYWQ6IGFueTtcbiAgZ3dTdGF0dXM6IEd3TWVzc2FnZVN0YXR1cztcbiAgZ3dNZXNzYWdlSWQ6IG51bWJlcjtcbiAgZ3dSZXNwb25zZVRvTWVzc2FnZUlkOiBudW1iZXIgfCBudWxsO1xuICBnd05vbkd3T3JpZ2luSWZBbnk/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR3dNZXNzYWdlRXZlbnQgZXh0ZW5kcyBNZXNzYWdlRXZlbnQge1xuICBkYXRhOiBHd01lc3NhZ2VEYXRhO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEd3Tm90aWZpY2F0aW9uIHtcbiAgdHlwZTogR3dOb3RpZmljYXRpb25UeXBlO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgaW5mbzogYW55O1xufVxuXG5leHBvcnQgdHlwZSBHd05vdGlmaWNhdGlvbkNhbGxiYWNrID0gKG5vdGlmaWNhdGlvbjogR3dOb3RpZmljYXRpb24pID0+IHZvaWQ7XG5cbmV4cG9ydCBpbnRlcmZhY2UgR3dDcm9zc09yaWdpbkV2ZW50IHtcbiAgZXZlbnROYW1lOiBHd0Nyb3NzT3JpZ2luRXZlbnROYW1lO1xuICBicm9hZGNhc3RlcldpbmRvd0lkOiBHd0Nyb3NzT3JpZ2luV2luZG93TmFtZTtcbiAgdGltZXN0YW1wOiBudW1iZXI7XG4gIGluZm86IGFueTtcbn1cblxuZXhwb3J0IHR5cGUgR3dDcm9zc09yaWdpbkV2ZW50TGlzdGVuZXJDYWxsYmFjayA9IChldmVudEluZm86IEd3Q3Jvc3NPcmlnaW5FdmVudCkgPT4gdm9pZDtcbmV4cG9ydCB0eXBlIEd3Q3Jvc3NPcmlnaW5XaW5kb3dOYW1lID0gc3RyaW5nO1xuZXhwb3J0IHR5cGUgR3dDcm9zc09yaWdpbkV2ZW50TmFtZSA9IHN0cmluZztcbmV4cG9ydCB0eXBlIEd3Q3Jvc3NPcmlnaW5FdmVudFJlcXVlc3QgPSB7XG4gIGJyb2FkY2FzdGVyV2luZG93TmFtZTogR3dDcm9zc09yaWdpbldpbmRvd05hbWU7XG4gIGV2ZW50TmFtZTogR3dDcm9zc09yaWdpbkV2ZW50TmFtZTtcbn07XG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiaW1wb3J0IHtcbiAgR3dDcm9zc09yaWdpbkV2ZW50LFxuICBHd0Nyb3NzT3JpZ2luRXZlbnRMaXN0ZW5lckNhbGxiYWNrLFxuICBHd0Nyb3NzT3JpZ2luRXZlbnROYW1lLFxuICBHd0Nyb3NzT3JpZ2luV2luZG93TmFtZSxcbiAgR3dLZXlWYWx1ZSxcbiAgR3dNZXNzYWdlRGF0YSxcbiAgR3dNZXNzYWdlRXZlbnQsXG4gIEd3TWVzc2FnZXNGcm9tR1csXG4gIEd3TWVzc2FnZVN0YXR1cyxcbiAgR3dNZXNzYWdlc1RvR1csXG4gIEd3Tm90aWZpY2F0aW9uLFxuICBHd05vdGlmaWNhdGlvbkNhbGxiYWNrLFxuICBHd05vdGlmaWNhdGlvblR5cGUsXG59IGZyb20gXCIuLi90eXBlcy9nd0Nyb3NzT3JpZ2luVHlwZXNcIjtcbmltcG9ydCB7IEd3VHlwZWRNYXAgfSBmcm9tIFwiLi4vdHlwZXMvZ3dUeXBlc1wiO1xuXG5pbnRlcmZhY2UgR3dNZXNzYWdlQXdhaXRpbmdSZXNwb25zZUluZm8ge1xuICBtZXNzYWdlSWQ6IG51bWJlcjtcbiAgZnVsZmlsbD86IChwYXlsb2FkOiBHd0tleVZhbHVlPGFueT4gfCBFcnJvciB8IG51bGwpID0+IHZvaWQ7XG4gIHJlamVjdD86IChwYXlsb2FkOiBHd0tleVZhbHVlPGFueT4gfCBFcnJvciB8IG51bGwpID0+IHZvaWQ7XG4gIHRpbWVzdGFtcDogbnVtYmVyO1xufVxuXG4vKipcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogUFJJTUFSWSBDTEFTU1xuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiBUaGlzIGVudGlyZSBmaWxlIGlzIGEgc3RhbmQgYWxvbmUgaW1wbGVtZW50YXRpb24gb2YgdGhlIEd3IGNyb3NzIG9yaWdpbiB3aW5kb3cgbWVzc2FnaW5nIHN5c3RlbS5cbiAqIEl0J3Mgc29sZSBwdXJwb3NlIGlzIHRvIGJlIHVzZWQgaW4gYSBjcm9zcyBvcmlnaW4gd2luZG93IGVudmlyb25tZW50IGZvciBlbWJlZGRlZCBhcHBsaWNhdGlvbnMuXG4gKlxuICogVGhpcyBTdGF0aWMgQ2xhc3MgaXMgdGhlIG9ubHkgQVBJLCBhbmQgdGhpcyBmaWxlIHJlbGllcyBvbiBubyBvdGhlciBpbXBvcnRzIChhcGFydCBmcm9tIHNvbWUgVHlwZVNjcmlwdFxuICogdHlwZSBkZWZpbml0aW9ucywgc2hhcmVkIHdpdGggdGhlIGludGVybmFsIEFQSXMpXG4gKlxuICogSWYgdGhlIGV4dGVybmFsIGFwcGxpY2F0aW9uIHBsYW5zIHRvIHN1cHBvcnQgYnJvd3NlcnMgb3IgZW52aXJvbm1lbnRzIHRoYXQgZG9uJ3QgbmF0aXZlbHkgc3VwcG9ydCBlczYgUHJvbWlzZSxcbiAqIHRoZW4gaXQgd2lsbCBuZWVkIGEgUHJvbWlzZSBwb2x5ZmlsbC4gR3dQcm9taXNlLnRzIGlzIG9uZSBvcHRpb24sIGFuZCBpcyBhIHN0YW5kIGFsb25lIHBvbHlmaWxsLlxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgR3dDcm9zc09yaWdpbkV4dGVybmFsIHtcbiAgcHJpdmF0ZSBzdGF0aWMgbmV4dE1lc3NhZ2VJZDogbnVtYmVyID0gMTAwMDtcblxuICBwcml2YXRlIHN0YXRpYyBpbml0aWFsaXplZDogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIHN0YXRpYyBvcmlnaW5Gb3JHd0FwcDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBtZXNzYWdlc0F3YWl0aW5nUmVzcG9uc2U6IEd3S2V5VmFsdWU8R3dNZXNzYWdlQXdhaXRpbmdSZXNwb25zZUluZm8+ID0ge307XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IGNyb3NzT3JpZ2luRXZlbnRDYWxsYmFja0J5QnJvYWRjYXN0ZXJUaGVuRXZlbnQ6IEd3S2V5VmFsdWU8R3dLZXlWYWx1ZTxHd0Nyb3NzT3JpZ2luRXZlbnRMaXN0ZW5lckNhbGxiYWNrPj4gPSB7fTtcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgZ3dOb3RpZmljYXRpb25MaXN0ZW5lcnM6IEd3S2V5VmFsdWU8R3dOb3RpZmljYXRpb25DYWxsYmFjaz4gPSB7fTtcbiAgcHJpdmF0ZSBzdGF0aWMgYWxsb3dMaXN0ZWREb21haW5zOiBHd0tleVZhbHVlPHRydWU+IHwgXCIqXCIgPSB7fTtcbiAgcHJpdmF0ZSBzdGF0aWMgb3duZXJXaW5kb3c6IFdpbmRvdztcbiAgcHJpdmF0ZSBzdGF0aWMgbWVzc2FnZUV2ZW50TGlzdGVuZXI6ICgoZXZlbnQ6IEd3TWVzc2FnZUV2ZW50KSA9PiB2b2lkKSB8IHVuZGVmaW5lZDtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlN0YXRpYyBjbGFzcy4gVXNlIEd3Q3Jvc3NPcmlnaW5FeHRlcm5hbC5pbml0KClcIik7XG4gIH1cblxuICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy89PT09IElOSVRJQUxJWkFUSU9OXG4gIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8qKlxuICAgKiBSZXF1aXJlZCBJbml0aWFsaXplciBmb3IgdGhlIEd3Q3Jvc3NPcmlnaW5FeHRlcm5hbCBBUEkuXG4gICAqIEFkZHMgYSAnbWVzc2FnZScgZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGdsb2JhbCB3aW5kb3dcbiAgICogQHBhcmFtIHtzdHJpbmd9IG9yaWdpbkZvckd3QXBwIC0gdGhlIG9yaWdpbiBvZiB0aGUgd2luZG93IChydW5uaW5nIHRoZSBHVyBBcHBsaWNhdGlvbikgdGhhdCBzcGF3bmVkIHRoaXMgd2luZG93XG4gICAqIEBwYXJhbSB7V2luZG93fSBmb3JjZWRPd25lcldpbmRvdyAtIHByaW1hcmlseSB1c2VkIGZvciB0ZXN0aW5nIGFuZCBtb2NraW5nLiBSZXBsYWNlcyBhbGwgY2FsbHMgdG8gdGhlIGdsb2JhbCB3aW5kb3cuXG4gICAqL1xuICBzdGF0aWMgaW5pdChvcmlnaW5Gb3JHd0FwcDogc3RyaW5nLCBhbGxvd0xpc3RlZERvbWFpbnM6IEd3S2V5VmFsdWU8dHJ1ZT4gfCBcIipcIiwgZm9yY2VkT3duZXJXaW5kb3c/OiBXaW5kb3cpOiB2b2lkIHtcbiAgICB0aGlzLm93bmVyV2luZG93ID0gZm9yY2VkT3duZXJXaW5kb3cgfHwgd2luZG93LnBhcmVudDtcbiAgICB0aGlzLmFsbG93TGlzdGVkRG9tYWlucyA9IGFsbG93TGlzdGVkRG9tYWlucztcbiAgICB0aGlzLm9yaWdpbkZvckd3QXBwID0gb3JpZ2luRm9yR3dBcHA7XG4gICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgdGhpcy5tZXNzYWdlRXZlbnRMaXN0ZW5lciA9IHRoaXMucmVjZWl2ZU1lc3NhZ2VGcm9tR3dBcHAuYmluZCh0aGlzKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgdGhpcy5tZXNzYWdlRXZlbnRMaXN0ZW5lciEsIGZhbHNlKTtcbiAgfVxuXG4gIHN0YXRpYyBpc0luaXRpYWxpemVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmluaXRpYWxpemVkO1xuICB9XG5cbiAgLyoqXG4gICAqIERpc2FibGVzIHRoZSBBUEkuIFJlbW92aW5nIGFueSBzZXR1cCBkb25lIGluIHRoZSBpbml0IG1ldGhvZC5cbiAgICovXG4gIHN0YXRpYyBraWxsKCk6IHZvaWQge1xuICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICB0aGlzLm9yaWdpbkZvckd3QXBwID0gdW5kZWZpbmVkO1xuICAgIGlmICh0aGlzLm1lc3NhZ2VFdmVudExpc3RlbmVyKSB7XG4gICAgICB0aGlzLm93bmVyV2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIHRoaXMubWVzc2FnZUV2ZW50TGlzdGVuZXIsIGZhbHNlKTtcbiAgICAgIHRoaXMubWVzc2FnZUV2ZW50TGlzdGVuZXIgPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9XG5cbiAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vPT09PSBSRUNFSVZFIE1FU1NBR0VTIEZST00gR1cgQVBQXG4gIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHByaXZhdGUgc3RhdGljIHRocm93SWZVbnRydXN0ZWRPcmlnaW4oZXZlbnQ6IEd3TWVzc2FnZUV2ZW50KTogdm9pZCB7XG4gICAgaWYgKHRoaXMub3duZXJXaW5kb3cgIT09IGV2ZW50LnNvdXJjZSB8fCB0aGlzLm9yaWdpbkZvckd3QXBwICE9PSBldmVudC5vcmlnaW4pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlJlY2VpdmVkIHVudHJ1c3RlZCBtZXNzYWdlIGZyb20gb3JpZ2luOiBcIiArIGV2ZW50Lm9yaWdpbik7XG4gICAgfVxuXG4gICAgaWYgKGV2ZW50LmRhdGEuZ3dOb25Hd09yaWdpbklmQW55KSB7XG4gICAgICBpZiAodGhpcy5hbGxvd0xpc3RlZERvbWFpbnMgIT09IFwiKlwiICYmICF0aGlzLmFsbG93TGlzdGVkRG9tYWluc1tldmVudC5kYXRhLmd3Tm9uR3dPcmlnaW5JZkFueV0pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUmVjZWl2ZWQgbWVzc2FnZSBmcm9tIHRydXN0ZWQgR1cgQXBwbGljYXRpb24gb3JpZ2luLCBidXQgZnJvbSBhbiBvcmlnaW5hdGluZyBvcmlnaW4gbm90IG9uIHRoZSBhbGxvdyBsaXN0LlwiKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVGhlIFByaW1hcnkgUm91dGVyIGZvciBBbGwgTWVzc2FnZXMgUmVjZWl2ZWQgZnJvbSB0aGUgR1cgQXBwbGljYXRpb25cbiAgICogSXQgaXMgYm91bmQgdGhlIFwibWVzc2FnZVwiIGV2ZW50IGxpc3RlbmVyIG9uIHRoZSBwYXJlbnQgd2luZG93LlxuICAgKlxuICAgKiBUSEVSRSBJUyBOTyBSRUFTT04gVE8gQ0FMTCBUSElTIE1FVEhPRCBESVJFQ1RMWVxuICAgKiBAcGFyYW0ge0d3TWVzc2FnZUV2ZW50fSBldmVudFxuICAgKi9cbiAgc3RhdGljIHJlY2VpdmVNZXNzYWdlRnJvbUd3QXBwKGV2ZW50OiBHd01lc3NhZ2VFdmVudCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudGhyb3dJZlVudHJ1c3RlZE9yaWdpbihldmVudCk7XG5cbiAgICBjb25zdCBkYXRhOiBHd01lc3NhZ2VEYXRhID0gZXZlbnQuZGF0YTtcblxuICAgIHN3aXRjaCAoZGF0YS5nd01lc3NhZ2VUeXBlKSB7XG4gICAgICBjYXNlIEd3TWVzc2FnZXNGcm9tR1cuVkFMVUVTOlxuICAgICAgICB0aGlzLnJlY2VpdmVWYWx1ZXNNZXNzYWdlKGRhdGEpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgR3dNZXNzYWdlc0Zyb21HVy5SRVNQT05TRV9GUk9NX05PTl9CTE9DS0lOR19TRVJWRVJfUkVRVUVTVDpcbiAgICAgICAgdGhpcy5yZWNlaXZlTm9uQmxvY2tpbmdTZXJ2ZXJSZXF1ZXN0UmVwb25zZU1lc3NhZ2UoZGF0YSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBHd01lc3NhZ2VzRnJvbUdXLkNPTkZJUk1BVElPTl9PTkxZOlxuICAgICAgICB0aGlzLnJlY2VpdmVDb25maXJtYXRpb25Pbmx5TWVzc2FnZShkYXRhKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEd3TWVzc2FnZXNGcm9tR1cuUkVDRUlWRV9DUk9TU19PUklHSU5fRVZFTlQ6XG4gICAgICAgIHRoaXMucmVjZWl2ZUNyb3NzT3JpZ2luRXZlbnQoZGF0YSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBHd01lc3NhZ2VzRnJvbUdXLlJFQ0VJVkVfR1dfTk9USUZJQ0FUSU9OOlxuICAgICAgICB0aGlzLnJlY2VpdmVHd05vdGlmaWNhdGlvbihkYXRhKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aGlzLnJlY2VpdmVOb25Db25mb3JtaW5nTWVzc2FnZVR5cGVGcm9tR3dBcHAoZXZlbnQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBIZWxwZXIuIFJldHJpZXZlcyBHd01lc3NhZ2VBd2FpdGluZ1Jlc3BvbnNlSW5mbyB3aGlsZSBsb2dnaW5nIGVycm9ycyBhbG9uZyB0aGUgd2F5XG4gICAqIEBwYXJhbSB7R3dNZXNzYWdlRGF0YX0gZGF0YVxuICAgKiBAcmV0dXJucyB7R3dNZXNzYWdlQXdhaXRpbmdSZXNwb25zZUluZm88YW55PiB8IG51bGx9XG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBnZXRBd2FpdGluZ0luZm9Gb3JDb3JyZXNwb25kaW5nTWVzc2FnZURhdGEoZGF0YTogR3dNZXNzYWdlRGF0YSk6IEd3TWVzc2FnZUF3YWl0aW5nUmVzcG9uc2VJbmZvIHwgbnVsbCB7XG4gICAgY29uc3QgcmVzcG9uc2VUb01lc3NhZ2VJZCA9IGRhdGEuZ3dSZXNwb25zZVRvTWVzc2FnZUlkO1xuXG4gICAgaWYgKCFyZXNwb25zZVRvTWVzc2FnZUlkICYmIHJlc3BvbnNlVG9NZXNzYWdlSWQgIT09IDApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJSZWNlaXZlZCB2YWx1ZXMgcGF5bG9hZCB3aXRoIG5vIHJlc3BvbnNlVG9NZXNzYWdlSWQgaWRlbnRpZmllcjogXCIsIGRhdGEpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgaW5mbzogR3dNZXNzYWdlQXdhaXRpbmdSZXNwb25zZUluZm8gPSB0aGlzLm1lc3NhZ2VzQXdhaXRpbmdSZXNwb25zZVtyZXNwb25zZVRvTWVzc2FnZUlkXTtcblxuICAgIGlmICgod2luZG93IGFzIGFueSkuR3dUZXN0RW52KSB7XG4gICAgICByZXR1cm4gaW5mbztcbiAgICB9XG5cbiAgICBpZiAoIWluZm8pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgIFwiUmVjZWl2ZWQgdmFsdWVzIHBheWxvYWQgd2l0aCBhIHJlc3BvbnNlVG9NZXNzYWdlSWQ6IFwiICtcbiAgICAgICAgICByZXNwb25zZVRvTWVzc2FnZUlkICtcbiAgICAgICAgICBcIi4gQnV0IGNvdWxkIG5vdCBsb2NhdGUgYSBjb3JyZXNwb25kaW5nIFByb21pc2UuIERhdGE6IFwiLFxuICAgICAgICBkYXRhXG4gICAgICApO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGluZm87XG4gIH1cblxuICAvKipcbiAgICogUHJvbWlzZSBSZXNvbHZlci5cbiAgICogVGFrZXMgYSBHd01lc3NhZ2VEYXRhIG9iamVjdC5cbiAgICogTG9jYXRlcyBsb2NhbGx5IHN0b3JlZCBwcm9taXNlcyByZWxhdGluZyB0aGUgdGhlIG1lc3NhZ2UsIGFuZCBmaXJlcyBmdWxmaWwgb3IgcmVqZWN0IGJhc2VkIG9uIG1lc3NhZ2Ugc3RhdHVzLlxuICAgKiBAcGFyYW0ge0d3TWVzc2FnZURhdGF9IGRhdGFcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIHJlY2VpdmVNZXNzYWdlKGRhdGE6IEd3TWVzc2FnZURhdGEpOiB2b2lkIHtcbiAgICBjb25zdCBwYXlsb2FkOiBHd0tleVZhbHVlPGFueT4gfCBFcnJvciB8IG51bGwgPSBkYXRhLmd3UGF5bG9hZDtcbiAgICBjb25zdCBzdGF0dXM6IEd3TWVzc2FnZVN0YXR1cyA9IGRhdGEuZ3dTdGF0dXM7XG5cbiAgICBjb25zdCBpbmZvOiBHd01lc3NhZ2VBd2FpdGluZ1Jlc3BvbnNlSW5mbyB8IG51bGwgPSB0aGlzLmdldEF3YWl0aW5nSW5mb0ZvckNvcnJlc3BvbmRpbmdNZXNzYWdlRGF0YShkYXRhKTtcbiAgICBpZiAoIWluZm8pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBjYWxsYmFjayA9IHN0YXR1cyA9PT0gR3dNZXNzYWdlU3RhdHVzLkZBSUxFRCA/IGluZm8ucmVqZWN0IDogaW5mby5mdWxmaWxsO1xuICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgY2FsbGJhY2socGF5bG9hZCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgcmVjZWl2ZU5vbkJsb2NraW5nU2VydmVyUmVxdWVzdFJlcG9uc2VNZXNzYWdlKGRhdGE6IEd3TWVzc2FnZURhdGEpOiB2b2lkIHtcbiAgICB0aGlzLnJlY2VpdmVNZXNzYWdlKGRhdGEpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgcmVjZWl2ZVZhbHVlc01lc3NhZ2UoZGF0YTogR3dNZXNzYWdlRGF0YSk6IHZvaWQge1xuICAgIHRoaXMucmVjZWl2ZU1lc3NhZ2UoZGF0YSk7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyByZWNlaXZlQ29uZmlybWF0aW9uT25seU1lc3NhZ2UoZGF0YTogR3dNZXNzYWdlRGF0YSk6IHZvaWQge1xuICAgIHRoaXMucmVjZWl2ZU1lc3NhZ2UoZGF0YSk7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyByZWNlaXZlQ3Jvc3NPcmlnaW5FdmVudChkYXRhOiBHd01lc3NhZ2VEYXRhKTogdm9pZCB7XG4gICAgY29uc3QgZXY6IEd3Q3Jvc3NPcmlnaW5FdmVudCA9IGRhdGEuZ3dQYXlsb2FkO1xuXG4gICAgY29uc3QgZXZlbnRzOiBHd1R5cGVkTWFwPEd3Q3Jvc3NPcmlnaW5FdmVudExpc3RlbmVyQ2FsbGJhY2s+ID1cbiAgICAgIHRoaXMuY3Jvc3NPcmlnaW5FdmVudENhbGxiYWNrQnlCcm9hZGNhc3RlclRoZW5FdmVudFtldi5icm9hZGNhc3RlcldpbmRvd0lkXTtcblxuICAgIGlmICghZXZlbnRzKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJSZWNlaXZlZCBjcm9zcyBvcmlnaW4gZXZlbnQgZnJvbSBhIGJyb2FkY2FzdCB3aW5kb3cgbm90IGN1cnJlbnRseSBiZWluZyBsaXN0ZW5lZCB0by5cIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgZXZlbnRMaXN0ZW5lckNhbGxiYWNrID0gZXZlbnRzW2V2LmV2ZW50TmFtZV0gfHwgZXZlbnRzW1wiKlwiXTtcblxuICAgIGlmICghZXZlbnRMaXN0ZW5lckNhbGxiYWNrKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIFwiUmVjZWl2ZWQgY3Jvc3Mgb3JpZ2luIGV2ZW50IGZvciBhbiBldmVudCB0eXBlIHdpdGhvdXQgYSByZWdpc3RlcmVkIGNhbGxiYWNrOiBcIiArIGV2LmJyb2FkY2FzdGVyV2luZG93SWQgKyBcIjpcIiArIGV2LmV2ZW50TmFtZVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBldmVudExpc3RlbmVyQ2FsbGJhY2soZXYpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgcmVjZWl2ZUd3Tm90aWZpY2F0aW9uKGRhdGE6IEd3TWVzc2FnZURhdGEpOiB2b2lkIHtcbiAgICBjb25zdCBub3RpZmljYXRpb246IEd3Tm90aWZpY2F0aW9uID0gZGF0YS5nd1BheWxvYWQ7XG5cbiAgICBjb25zdCBjYWxsYmFjazogR3dOb3RpZmljYXRpb25DYWxsYmFjayA9IHRoaXMuZ3dOb3RpZmljYXRpb25MaXN0ZW5lcnNbbm90aWZpY2F0aW9uLnR5cGVdO1xuICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgY2FsbGJhY2sobm90aWZpY2F0aW9uKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyByZWNlaXZlTm9uQ29uZm9ybWluZ01lc3NhZ2VUeXBlRnJvbUd3QXBwKGV2ZW50OiBNZXNzYWdlRXZlbnQpOiB2b2lkIHtcbiAgICBjb25zdCBwb3NzaWJsZUN1c3RvbU1ldGhvZE5hbWUgPSAodGhpcyBhcyBhbnkpW2V2ZW50LmRhdGEuZ3dNZXNzYWdlVHlwZV07XG5cbiAgICBpZiAodHlwZW9mIHBvc3NpYmxlQ3VzdG9tTWV0aG9kTmFtZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAodGhpcyBhcyBhbnkpW3Bvc3NpYmxlQ3VzdG9tTWV0aG9kTmFtZV0oZXZlbnQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnNvbGUud2FybihcbiAgICAgIFwiLS0tIFJlY2VpdmVkIE1lc3NhZ2VFdmVudCBmcm9tIEd3QXBwIHdpdGhvdXQgYSBnd01lc3NhZ2VUeXBlIHRoYXQgbWF0Y2hlZCBhIG1ldGhvZCBvbiBHd0Nyb3NzT3JpZ2luRXh0ZXJuYWwuXFxuXCIgK1xuICAgICAgICBcIi0tLSBUaGlzIGlzIGxpa2VseSBhbiBFcnJvci5cXG5cIiArXG4gICAgICAgIFwiLS0tIEhvd2V2ZXIsIHJlY2VpdmVOb25Db25mb3JtaW5nTWVzc2FnZVR5cGVGcm9tR3dBcHAgY2FuIGJlIG92ZXJyaWRkZW4gaW4gR3dDcm9zc09yaWdpbkV4dGVybmFsLlxcblwiICtcbiAgICAgICAgXCItLS0gVGhpcyBhbGxvd3MgY3VzdG9tIGxvZ2ljIGJhc2VkIG9uIGFueSBNZXNzYWdlRXZlbnQgdGhhdCBkb2VzIG5vdCBpbXBsZW1lbnQgR3dNZXNzYWdlRXZlbnQuIEJ1dCBjb25zaWRlciBNZXNzYWdlVHlwZS5GSVJFX0NVU1RPTV9FVkVOVCBpbnN0ZWFkLlwiXG4gICAgKTtcbiAgfVxuXG4gIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLz09PT0gU0VORCBNRVNTQUdFUyBUTyBHVyBBUFBcbiAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgLyoqXG4gICAqIFByaXZhdGUgUHJpbWFyeSByb3V0ZXIgZm9yIGFsbCBvdXRnb2luZyBtZXNzYWdlcyB0byB0aGUgR3cgQXBwbGljYXRpb24uXG4gICAqIEBwYXJhbSB7R3dNZXNzYWdlc1RvR1d9IG1lc3NhZ2VUeXBlXG4gICAqIEBwYXJhbSBwYXlsb2FkXG4gICAqIEBwYXJhbSB7bnVtYmVyIHwgbnVsbH0gcmVzcG9uc2VUb01lc3NhZ2VJZFxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fVxuICAgKi9cblxuICBwcml2YXRlIHN0YXRpYyBzZW5kTWVzc2FnZShtZXNzYWdlVHlwZTogR3dNZXNzYWdlc1RvR1csIHBheWxvYWQ6IGFueSwgcmVzcG9uc2VUb01lc3NhZ2VJZDogbnVtYmVyIHwgbnVsbCA9IG51bGwpOiBQcm9taXNlPGFueT4ge1xuICAgIGlmICghdGhpcy5vd25lcldpbmRvdykge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFxuICAgICAgICBuZXcgRXJyb3IoXCJBdHRlbXB0aW5nIHRvIHNlbmQgYSBtZXNzYWdlIHRvIGEgbnVsbCBHd0FwcCB3aW5kb3cuIEVuc3VyZSB0aGF0IHRoaXMgd2luZG93IHdhcyBzcGF3bmVkIGJ5IGEgR3VpZHdpcmUgQXBwbGljYXRpb24uXCIpXG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IG1lc3NhZ2VJZCA9IHRoaXMubmV4dE1lc3NhZ2VJZCsrO1xuXG4gICAgY29uc3QgZGF0YTogR3dNZXNzYWdlRGF0YSA9IHtcbiAgICAgIGd3TWVzc2FnZVR5cGU6IG1lc3NhZ2VUeXBlLFxuICAgICAgZ3dQYXlsb2FkOiBwYXlsb2FkLFxuICAgICAgZ3dTdGF0dXM6IEd3TWVzc2FnZVN0YXR1cy5QRU5ESU5HLFxuICAgICAgZ3dNZXNzYWdlSWQ6IG1lc3NhZ2VJZCxcbiAgICAgIGd3UmVzcG9uc2VUb01lc3NhZ2VJZDogcmVzcG9uc2VUb01lc3NhZ2VJZCxcbiAgICB9O1xuXG4gICAgY29uc3QgbWVzc2FnZUF3YWl0aW5nUmVzcG9uc2U6IEd3TWVzc2FnZUF3YWl0aW5nUmVzcG9uc2VJbmZvID0ge1xuICAgICAgbWVzc2FnZUlkLFxuICAgICAgdGltZXN0YW1wOiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCksXG4gICAgfTtcbiAgICB0aGlzLm1lc3NhZ2VzQXdhaXRpbmdSZXNwb25zZVttZXNzYWdlSWRdID0gbWVzc2FnZUF3YWl0aW5nUmVzcG9uc2U7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChmdWxmaWxsLCByZWplY3QpID0+IHtcbiAgICAgICAgbWVzc2FnZUF3YWl0aW5nUmVzcG9uc2UuZnVsZmlsbCA9IGZ1bGZpbGw7XG4gICAgICAgIG1lc3NhZ2VBd2FpdGluZ1Jlc3BvbnNlLnJlamVjdCA9IHJlamVjdDtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5vd25lcldpbmRvdy5wb3N0TWVzc2FnZShkYXRhLCB0aGlzLm9yaWdpbkZvckd3QXBwISk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRlbGxzIHRoZSBHVyBBcHBsaWNhdGlvbiB0byB1cGRhdGUgdGhlIERPTSBFbGVtZW50cyAoZm9yIHRoZSB3aWRnZXRzIHdob3NlIElEcyBjb3JyZXNwb25kIHRvIHRoZSBsb2dpY2FsIG5hbWUgbWFwcGluZyksIHdpdGggbmV3IHZhbHVlcy5cbiAgICogTk9URTogdGhpcyBkb2VzIG5vdCBhdXRvbWF0aWNhbGx5IHVwZGF0ZSBzZXJ2ZXIgdmFsdWVzIGZvciB0aGUgZWxlbWVudHMuIE9ubHkgdGhlIHZhbHVlcyBpbiB0aGUgRE9NIGluIHRoZSBHVyBBcHBsaWNhdGlvbi5cbiAgICogSWYgdGhlIFBhZ2UgaXMgaW4gcmVhZG9ubHkgbW9kZSwgb3IgdGhlIHVzZXIgY2FuY2VscyB0aGUgY2hhbmdlcywgdGhlIGNoYW5nZXMgd2lsbCBiZSBsb3N0LlxuICAgKlxuICAgKiBTZWU6IEd3Q3Jvc3NPcmlnaW5FeHRlcm5hbC5maXJlQWN0aW9uT25TZXJ2ZXIsIG9yIEd3Q3Jvc3NPcmlnaW5FeHRlcm5hbC5tYWtlTm9uQmxvY2tpbmdTZXJ2ZXJSZXF1ZXN0IGZvciBkaXJlY3RcbiAgICogY29tbXVuaWNhdGlvbiB3aXRoIHRoZSBHdyBBcHBsaWNhdGlvbiBTZXJ2ZXIuXG4gICAqXG4gICAqIFRoZSByZXR1cm5lZCBwcm9taXNlIGlzIG9ubHkgZm9yIGNvbmZpcm1hdGlvbiB0aGF0IHRoZSBtZXNzYWdlIHdhcyBzdWNjZXNzZnVsXG4gICAqXG4gICAqIEBwYXJhbSB7R3dWYWx1ZU1hcH0gbG9naWNhbE5hbWVUb1ZhbHVlTWFwIC0gJ0xvZ2ljYWwgTmFtZXMnIGFyZSBleHBvc2VkIGFzIGEgbWFwcGluZyBpbiBFbWJlZGRpbmdXaWRnZXQgQVBJLlxuICAgKiBBbmQgY29ycmVzcG9uZCB0byBhIHNldCBvZiB3aWRnZXQgSURzIGluIGEgZ2l2ZW4gaW5zdGFuY2Ugb2YgdGhlIEVtYmVkZGluZ1dpZGdldC4gaWU6XG4gICAqIExvZ2ljYWwgTmFtZTogQWRkcmVzc0xpbmUxID0+IFdpZGdldElkLXBhZ2U5LXBhbmVsOC1hZGRyZXNzc2VjdGlvbjctYWRkcmVzc2xpbmUxLlxuICAgKiBMaWdpY2FsIE5hbWU6IFppcENvZGUgPT4gV2lkZ2V0SWQtcGFnZTktcGFuZWw4LWFkZHJlc3NzZWN0aW9uNy16aXBjb2RlLlxuICAgKiBTZWUgdGhlIFBDRiBmaWVsZHMgZm9yIEVtYmVkZGluZ1dpZGdldFxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxHd1ZhbHVlTWFwPn1cbiAgICovXG5cbiAgc3RhdGljIHNldFZhbHVlcyhsb2dpY2FsTmFtZVRvVmFsdWVNYXA6IEd3S2V5VmFsdWU8c3RyaW5nPik6IFByb21pc2U8R3dLZXlWYWx1ZTxzdHJpbmc+PiB7XG4gICAgcmV0dXJuIHRoaXMuc2VuZE1lc3NhZ2UoR3dNZXNzYWdlc1RvR1cuU0VUX1ZBTFVFUywgbG9naWNhbE5hbWVUb1ZhbHVlTWFwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSB2YWx1ZXMgb2YgdGhlIGNvcnJlc3BvbmRpbmcgd2lkZ2V0cyBhcyBjdXJyZW50bHkgcmVwcmVzZW50ZWQgaW4gdGhlIERPTS5cbiAgICogTm90ZTogdGhpcyByZXR1cm5zIHRoZSB2YWx1ZXMgYXMgY3VycmVudGx5IHJlcHJlc2VudGVkIGluIHRoZSBET00uIFRoZXNlIHZhbHVlcyBDT1VMRCBiZSBkaWZmZXJlbnRcbiAgICogZnJvbSB0aGUgcGVyc2lzdGVkIHNlcnZlciB2YWx1ZXMgZm9yIGFueSBudW1iZXIgb2YgcmVhc29uczogdGhlIHVzZXIgbW9kaWZpZWQgdGhlbSBsb2NhbGx5LCBjbGllbnQgcmVmbGVjdGlvblxuICAgKiBtb2RpZmllZCB0aGVtLCBldGMuXG4gICAqXG4gICAqIFRoZSByZXR1cm5lZCBwcm9taXNlIHdpbGwgY29udGFpbiB0aGUgdmFsdWVzIHdoZW4gZnVsZmlsbGVkXG4gICAqIEBwYXJhbSB7c3RyaW5nW119IGxvZ2ljYWxOYW1lcyAtICdMb2dpY2FsIE5hbWVzJyBhcmUgZXhwb3NlZCBhcyBhIG1hcHBpbmcgaW4gRW1iZWRkaW5nV2lkZ2V0IEFQSS5cbiAgICogQW5kIGNvcnJlc3BvbmQgdG8gYSBzZXQgb2Ygd2lkZ2V0IElEcyBpbiBhIGdpdmVuIGluc3RhbmNlIG9mIHRoZSBFbWJlZGRpbmdXaWRnZXQuIGllOlxuICAgKiBMb2dpY2FsIE5hbWU6IEFkZHJlc3NMaW5lMSA9PiBXaWRnZXRJZC1wYWdlOS1wYW5lbDgtYWRkcmVzc3NlY3Rpb243LWFkZHJlc3NsaW5lMS5cbiAgICogTGlnaWNhbCBOYW1lOiBaaXBDb2RlID0+IFdpZGdldElkLXBhZ2U5LXBhbmVsOC1hZGRyZXNzc2VjdGlvbjctemlwY29kZS5cbiAgICogU2VlIHRoZSBQQ0YgZmllbGRzIGZvciBFbWJlZGRpbmdXaWRnZXRcbiAgICogQHJldHVybnMge1Byb21pc2U8R3dWYWx1ZU1hcD59XG4gICAqL1xuXG4gIHN0YXRpYyBnZXRWYWx1ZXMobG9naWNhbE5hbWVzOiBzdHJpbmdbXSk6IFByb21pc2U8R3dLZXlWYWx1ZTxzdHJpbmc+PiB7XG4gICAgcmV0dXJuIHRoaXMuc2VuZE1lc3NhZ2UoR3dNZXNzYWdlc1RvR1cuR0VUX1ZBTFVFUywgbG9naWNhbE5hbWVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxscyB0aGUgRW1iZWRkZWQgV2lkZ2V0J3Mgc2VydmVyIHNpZGUgQUNUSU9OIEhBTkRMRVIgd2l0aCB0aGUgZ2l2ZW4gSlNPTlxuICAgKiBvYmplY3QgYXMgaXRzIGFyZ3VtZW50LiBUaGlzIHdpbGwgY2F1c2UgYSBmdWxsIFVJIHJlZnJlc2guXG4gICAqXG4gICAqIFRoZSByZXR1cm5lZCBwcm9taXNlIGlzIG9ubHkgZm9yIGNvbmZpcm1hdGlvbiB0aGF0IHRoZSBtZXNzYWdlIHdhcyBzdWNjZXNzZnVsLCBub3QgdGhlIHJlc3VsdCBvZiB0aGUgYWN0aW9uIG9uIHRoZSBzZXJ2ZXJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGpzb25QYXlsb2FkXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59XG4gICAqL1xuXG4gIHN0YXRpYyBmaXJlQWN0aW9uT25TZXJ2ZXIocGF5bG9hZDogR3dLZXlWYWx1ZTxhbnk+KTogUHJvbWlzZTxhbnk+IHtcbiAgICByZXR1cm4gdGhpcy5zZW5kTWVzc2FnZShHd01lc3NhZ2VzVG9HVy5GSVJFX0FDVElPTiwgcGF5bG9hZCk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbHMgdGhlIEVtYmVkZGVkIFdpZGdldCdzIHNlcnZlciBzaWRlIFVQREFURSBIQU5ETEVSIHdpdGggdGhlIGdpdmVuIG9iamVjdFxuICAgKiBvYmplY3QgYXMgaXRzIGFyZ3VtZW50LiBUaGlzIHdpbGwgbm90IGJsb2NrIG9yIHJlZnJlc2ggdGhlIEdXIEFwcGxpY2F0aW9uIFVJLlxuICAgKlxuICAgKiBOT1RFOiBUaGUgUHJvbWlzZSByZXR1cm5lZCBieSB0aGlzIG1ldGhvZCB3aWxsIGNvbnRhaW4gdGhlIHBheWxvYWQgZnJvbSB0aGlzIHJlcXVlc3QuXG4gICAqL1xuXG4gIHN0YXRpYyBtYWtlTm9uQmxvY2tpbmdTZXJ2ZXJSZXF1ZXN0KHBheWxvYWQ6IEd3S2V5VmFsdWU8YW55Pik6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMuc2VuZE1lc3NhZ2UoR3dNZXNzYWdlc1RvR1cuTk9OX0JMT0NLSU5HX1NFUlZFUl9SRVFVRVNULCBwYXlsb2FkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdWJzY3JpYmUgdG8gYW5vdGhlciBFeHRlcm5hbCBDcm9zcyBPcmlnaW4gd2luZG93J3MgbWVzc2FnZXMuXG4gICAqIEltYWdpbmUgdGhhdCB0aGUgR3cgQXBwbGljYXRpb24gaGFzIDIgZW1iZWRkZWQgaWZyYW1lJ3MuIFRoZSBCbHVlIFdpbmRvdywgYW5kIHRoZSBSZWQgV2luZG93LlxuICAgKiBCbHVlIHdpbmRvdyBjYW4gYnJvYWRjYXN0IGEgY3VzdG9tIGNyb3NzIG9yaWdpbiBldmVudC4gTGV0J3Mgc2F5IFwiR09fQkFOQU5BU1wiLiBBbmQgaW5jbHVkZSBzb21lIGluZm9ybWF0aW9uOiB7bnVtYmVyT2ZCYW5hbmFzOiAxMn1cbiAgICogQmx1ZSB3aW5kb3cgd2lsbCBzZW5kIHRoYXQgcGFja2FnZSB0byB0aGUgR3dBcHBsaWNhdGlvbiB2aWEgYnJvYWRjYXN0Q3Jvc3NPcmlnaW5FdmVudC5cbiAgICogUmVkIHdpbmRvdyB3aWxsIG5ldmVyIGhlYXIgYWJvdXQgdGhpcyBtZXNzYWdlLlxuICAgKlxuICAgKiBCdXQgaWYgUmVkIFdpbmRvdyBjYWxscyBhZGRDcm9zc09yaWdpbkV2ZW50TGlzdGVuZXIsIHBhc3NpbmcgXCJyZWRXaW5kb3dcIiBhbmQgXCJHT19CQU5BTkFTXCIgdGhlbiB0aGUgR3cgQXBwbGljYXRpb25cbiAgICogd2lsbCByb3V0ZSB0aGUgbWVzc2FnZSBldmVudCB0byB0aGUgYmx1ZSB3aW5kb3csIGFuZCBjYWxsIHRoZSBwcm92aWRlZCBjYWxsYmFjayBmdW5jdGlvbi5cbiAgICpcbiAgICogTGlrZSBnZXQvc2V0IHZhbHVlcyB0aGlzIGZ1bmN0aW9uIHVzZXMgbG9naWNhbCBuYW1lcywgYXMgZ2l2ZW4gdG8gdGhlIGVtYmVkZGVkIHdpZGdldCB2aWFcbiAgICogdGhlIEVtYmVkZGVkV2lkZ2V0UmVmIGVsZW1lbnQuIFRob3VnaCBpbiB0aGlzIGNhc2UgdGhlIGxvZ2ljYWwgbmFtZXMgcmVmZXIgdG8gYW5vdGhlclxuICAgKiBlbWJlZGRlZCB3aWRnZXQgcmF0aGVyIHRoYW4gdG8gYW4gaW5wdXQuXG4gICAqXG4gICAqIE5PVEU6IHRvIHJlY2VpdmUgbWVzc2FnZXMgZnJvbSBhbnkgb3RoZXIgZXh0ZXJuYWwgd2luZG93cywgdGhleSBtdXN0IGJlIGV4cGxpY2l0bHkgYWxsb3cgbGlzdGVkIHZpYSB0aGVcbiAgICogR3dDcm9zc09yaWdpbkV4dGVybmFsLmluaXQgbWV0aG9kLCBlaXRoZXIgYnkgZG9tYWluLCBvciBieSBzcGVjaWZ5aW5nIGEgd2lsZGNhcmQgZG9tYWluLlxuICAgKlxuICAgKiBUaGUgcmV0dXJuZWQgcHJvbWlzZSBpcyBvbmx5IGZvciBjb25maXJtYXRpb24gdGhhdCB0aGUgbWVzc2FnZSB3YXMgc3VjY2Vzc2Z1bFxuICAgKiBAcGFyYW0gYnJvYWRjYXN0ZXJXaW5kb3dOYW1lIHRoZSBsb2dpY2FsIG5hbWUgb2YgdGhlIHdpbmRvdyB5b3Ugd2FudCB0byBsaXN0ZW4gdG9cbiAgICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50TmFtZSBuYW1lIG9mIHRoZSBldmVudCwgb3IgXCIqXCIgdG8gbGlzdGVuIHRvIGFueSBldmVudFxuICAgKiBAcGFyYW0ge0d3RXZlbnRJbmZvQ2FsbGJhY2t9IGNhbGxiYWNrXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59XG4gICAqL1xuXG4gIHN0YXRpYyBhZGRDcm9zc09yaWdpbkV2ZW50TGlzdGVuZXIoXG4gICAgYnJvYWRjYXN0ZXJXaW5kb3dOYW1lOiBHd0Nyb3NzT3JpZ2luV2luZG93TmFtZSxcbiAgICBldmVudE5hbWU6IEd3Q3Jvc3NPcmlnaW5FdmVudE5hbWUsXG4gICAgY2FsbGJhY2s6IEd3Q3Jvc3NPcmlnaW5FdmVudExpc3RlbmVyQ2FsbGJhY2tcbiAgKTogUHJvbWlzZTxhbnk+IHtcbiAgICBsZXQgY3VycmVudGx5TGlzdGVuZWRUb0V2ZW50cyA9ICh0aGlzLmNyb3NzT3JpZ2luRXZlbnRDYWxsYmFja0J5QnJvYWRjYXN0ZXJUaGVuRXZlbnRbYnJvYWRjYXN0ZXJXaW5kb3dOYW1lXSA9XG4gICAgICB0aGlzLmNyb3NzT3JpZ2luRXZlbnRDYWxsYmFja0J5QnJvYWRjYXN0ZXJUaGVuRXZlbnRbYnJvYWRjYXN0ZXJXaW5kb3dOYW1lXSB8fCB7fSk7XG5cbiAgICBpZiAoY3VycmVudGx5TGlzdGVuZWRUb0V2ZW50c1tcIipcIl0pIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChcbiAgICAgICAgbmV3IEVycm9yKFxuICAgICAgICAgIFwiVGhlcmUgaXMgYWxyZWFkeSBhbiAnYWxsJyBsaXN0ZW5lciAoYCpgKSBmb3IgdGhpcyBicm9hZGNhc3Rlci4gUmVtb3ZlIGl0IGJlZm9yZSBhZGRpbmcgYW55IG90aGVyIGxpc3RlbmVyczogXCIgK1xuICAgICAgICAgICAgYnJvYWRjYXN0ZXJXaW5kb3dOYW1lICtcbiAgICAgICAgICAgIFwiOlwiICtcbiAgICAgICAgICAgIGV2ZW50TmFtZVxuICAgICAgICApXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChjdXJyZW50bHlMaXN0ZW5lZFRvRXZlbnRzW2V2ZW50TmFtZV0pIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChcbiAgICAgICAgbmV3IEVycm9yKFwiQ2Fubm90IHJlZ2lzdGVyIG11bHRpcGxlIGNhbGxiYWNrcyBmb3IgdGhlIHNhbWUgYnJvYWRjYXN0ZXIgYW5kIGV2ZW50OiBcIiArIGJyb2FkY2FzdGVyV2luZG93TmFtZSArIFwiOlwiICsgZXZlbnROYW1lKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoZXZlbnROYW1lID09PSBcIipcIiAmJiBPYmplY3Qua2V5cyhjdXJyZW50bHlMaXN0ZW5lZFRvRXZlbnRzKS5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIFwiQWRkaW5nIGFuICdhbGwnIGxpc3RlbmVyIG9mICcqJyB0byBhIGJyb2FkY2FzdGVyIHRoYXQgYWxyZWFkeSBoYXMgbW9yZSBzcGVjaWZpYyBsaXN0ZW5lci4gQWxsIHNwZWNpZmljIGxpc3RlbmVycyB3aWxsIGJlIHJlbW92ZWQuIEluIG9yZGVyIHRvIGF2b2lkIHRoaXMgd2FybmluZywgcmVtb3ZlIGtub3duIGxpc3RlbmVycyBtYW51YWxseSBiZWZvcmUgYWRkaW5nLlwiXG4gICAgICApO1xuICAgICAgY3VycmVudGx5TGlzdGVuZWRUb0V2ZW50cyA9IHRoaXMuY3Jvc3NPcmlnaW5FdmVudENhbGxiYWNrQnlCcm9hZGNhc3RlclRoZW5FdmVudFticm9hZGNhc3RlcldpbmRvd05hbWVdID0ge307XG4gICAgfVxuXG4gICAgY3VycmVudGx5TGlzdGVuZWRUb0V2ZW50c1tldmVudE5hbWVdID0gY2FsbGJhY2s7XG5cbiAgICByZXR1cm4gdGhpcy5zZW5kTWVzc2FnZShHd01lc3NhZ2VzVG9HVy5BRERfQ1JPU1NfT1JJR0lOX0VWRU5UX0xJU1RFTkVSLCB7IGJyb2FkY2FzdGVyV2luZG93TmFtZSwgZXZlbnROYW1lIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgdGhlIENyb3NzIE9yaWdpbiBFdmVudCBMaXN0ZW5lciBmcm9tIHRoZSBHVyBBcHBsaWNhdGlvbiB3aW5kb3dcbiAgICogU2VlIEd3Q3Jvc3NPcmlnaW5FeHRlcm5hbC5hZGRDcm9zc09yaWdpbkV2ZW50TGlzdGVuZXIuXG4gICAqXG4gICAqIExpa2UgZ2V0L3NldCB2YWx1ZXMgdGhpcyBmdW5jdGlvbiB1c2VzIGxvZ2ljYWwgbmFtZXMsIGFzIGdpdmVuIHRvIHRoZSBlbWJlZGRlZCB3aWRnZXQgdmlhXG4gICAqIHRoZSBFbWJlZGRlZFdpZGdldFJlZiBlbGVtZW50LiBUaG91Z2ggaW4gdGhpcyBjYXNlIHRoZSBsb2dpY2FsIG5hbWVzIHJlZmVyIHRvIGFub3RoZXJcbiAgICogZW1iZWRkZWQgd2lkZ2V0IHJhdGhlciB0aGFuIHRvIGFuIGlucHV0LlxuICAgKlxuICAgKiBUaGUgcmV0dXJuZWQgcHJvbWlzZSBpcyBvbmx5IGZvciBjb25maXJtYXRpb24gdGhhdCB0aGUgbWVzc2FnZSB3YXMgc3VjY2Vzc2Z1bFxuICAgKiBAcGFyYW0gYnJvYWRjYXN0ZXJXaW5kb3dOYW1lIHRoZSBsb2dpY2FsIG5hbWUgb2YgdGhlIHdpbmRvdyB5b3Ugd2FudCB0byBzdG9wIGxpc3RlbmluZyB0b1xuICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnROYW1lIG5hbWUgb2YgdGhlIGV2ZW50LCBvciBcIipcIiBpZiByZWdpc3RlcmQgdG8gbGlzdGVuIHRvIGFueSBldmVudFxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fVxuICAgKi9cblxuICBzdGF0aWMgcmVtb3ZlQ3Jvc3NPcmlnaW5FdmVudExpc3RlbmVyKGJyb2FkY2FzdGVyV2luZG93TmFtZTogR3dDcm9zc09yaWdpbldpbmRvd05hbWUsIGV2ZW50TmFtZTogR3dDcm9zc09yaWdpbkV2ZW50TmFtZSk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgYnlCcm9hZGNhc3RlciA9IHRoaXMuY3Jvc3NPcmlnaW5FdmVudENhbGxiYWNrQnlCcm9hZGNhc3RlclRoZW5FdmVudFticm9hZGNhc3RlcldpbmRvd05hbWVdO1xuXG4gICAgaWYgKGJ5QnJvYWRjYXN0ZXIpIHtcbiAgICAgIGlmIChldmVudE5hbWUgPT09IFwiKlwiKSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLmNyb3NzT3JpZ2luRXZlbnRDYWxsYmFja0J5QnJvYWRjYXN0ZXJUaGVuRXZlbnRbYnJvYWRjYXN0ZXJXaW5kb3dOYW1lXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRlbGV0ZSBieUJyb2FkY2FzdGVyW2V2ZW50TmFtZV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuc2VuZE1lc3NhZ2UoR3dNZXNzYWdlc1RvR1cuUkVNT1ZFX0NST1NTX09SSUdJTl9FVkVOVF9MSVNURU5FUiwgeyBicm9hZGNhc3RlcldpbmRvd05hbWUsIGV2ZW50TmFtZSB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCcm9hZGNhc3RzIGEgQ3Jvc3MgT3JpZ2luIEV2ZW50IChNZXNzYWdlKSB0byB0aGUgR1cgQXBwbGljYXRpb24gY2xpZW50LiBUaGUgR1cgQXBwbGljYXRpb24gdGhlbiByb3V0ZXMgdGhlIG1lc3NhZ2UgZXZlbnRcbiAgICogYW5kIGluZm9ybWF0aW9uIHBhY2thZ2Ugb24gdG8gYW55IG90aGVyIGVtYmVkZGVkIHdpbmRvd3MgaW4gdGhlIGFwcGxpY2F0aW9uIHRoYXQgYXJlIGxpc3RlbmluZyB0byB0aGUgb3JpZ2luIGFuZCBldmVudCBuYW1lLlxuICAgKiBTZWUgR3dDcm9zc09yaWdpbkV4dGVybmFsLmFkZENyb3NzT3JpZ2luRXZlbnRMaXN0ZW5lci5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50TmFtZVxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fVxuICAgKi9cblxuICBzdGF0aWMgYnJvYWRjYXN0Q3Jvc3NPcmlnaW5FdmVudChldmVudE5hbWU6IEd3Q3Jvc3NPcmlnaW5FdmVudE5hbWUsIGluZm86IGFueSk6IFByb21pc2U8YW55PiB7XG4gICAgaWYgKGV2ZW50TmFtZS5sZW5ndGggPT09IDAgfHwgZXZlbnROYW1lID09PSBcIipcIikge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFxuICAgICAgICBuZXcgRXJyb3IoXCJJbGxlZ2FsIGV2ZW50TmFtZSBwYXNzZWQgdG8gZmlyZUNyb3NzT3JpZ2luRXZlbnQuIENhbm5vdCBiZSBlbXB0eSBvciB0aGUgc2luZ2xlIGAqYCBjaGFyYWN0ZXI6IFwiICsgZXZlbnROYW1lKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5zZW5kTWVzc2FnZShHd01lc3NhZ2VzVG9HVy5CUk9BRENBU1RfQ1JPU1NfT1JJR0lOX0VWRU5ULCB7IGV2ZW50TmFtZSwgaW5mbyB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgR3cgQXBwbGljYXRpb24gc2VuZHMgJ2V2ZW50cycgZm9yIHNvbWUgcHJlZGVmaW5lZCBjbGllbnQgcmVsYXRlZCBub3RpZmljYXRpb25zLCBzdWNoIGFzIHRoZSBUaGVtZSBDaGFuZ2luZywgb3IgdGhlIExvY2FsZSBjaGFuZ2luZy5cbiAgICogVGhlcmUgaXMgYWxzbyBhIEdFTkVSQUwgY2F0ZWdvcnkgdGhhdCBleGlzdHMgbWFpbmx5IGZvciBmdXR1cmUgcHJvb2ZpbmcuIEFkZGl0aW9uYWwgZXZlbnRzIG1heSBiZSBjb25maWd1cmVkIGluIHRoZSBmdXR1cmUuXG4gICAqIEBwYXJhbSB7R3dOb3RpZmljYXRpb25UeXBlfSBub3RpZmljYXRpb25UeXBlXG4gICAqIEBwYXJhbSB7R3dOb3RpZmljYXRpb25DYWxsYmFja30gY2FsbGJhY2tcbiAgICovXG4gIHN0YXRpYyBhZGRDYWxsYmFja0Zvckd3Tm90aWZpY2F0aW9uVHlwZShub3RpZmljYXRpb25UeXBlOiBHd05vdGlmaWNhdGlvblR5cGUsIGNhbGxiYWNrOiBHd05vdGlmaWNhdGlvbkNhbGxiYWNrKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZ3dOb3RpZmljYXRpb25MaXN0ZW5lcnNbbm90aWZpY2F0aW9uVHlwZV0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgXCJBdHRlbXB0aW5nIHRvIGxvYWQgbXVsdGlwbGUgY2FsbGJhY2tzIGZvciBub3RpZmljYXRpb24gdHlwZTogXCIgK1xuICAgICAgICAgIG5vdGlmaWNhdGlvblR5cGUgK1xuICAgICAgICAgIFwiLiBjYWxsIHJlbW92ZUNhbGxiYWNrQmFja0ZvckdXTm90aWZpY2F0aW9uVHlwZSBmaXJzdC5cIlxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuZ3dOb3RpZmljYXRpb25MaXN0ZW5lcnNbXCIqXCJdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0aW5nIHRvIGxvYWQgYSBub3RpZmljYXRpb24gbGlzdGVuZXIgd2hlbiB0aGVpciBpcyBhbHJlYWR5IGEgKiBsaXN0ZW5lci4gTmV3IGxpc3RlbmVyOiBcIiArIG5vdGlmaWNhdGlvblR5cGUpO1xuICAgIH1cbiAgICB0aGlzLmd3Tm90aWZpY2F0aW9uTGlzdGVuZXJzW25vdGlmaWNhdGlvblR5cGVdID0gY2FsbGJhY2s7XG4gIH1cblxuICAvKipcbiAgICogVGhlIEd3IEFwcGxpY2F0aW9uIHNlbmRzICdldmVudHMnIGZvciBzb21lIHByZWRlZmluZWQgY2xpZW50IHJlbGF0ZWQgbm90aWZpY2F0aW9ucywgc3VjaCBhcyB0aGUgVGhlbWUgQ2hhbmdpbmcsIG9yIHRoZSBMb2NhbGUgY2hhbmdpbmcuXG4gICAqIFRoZXJlIGlzIGFsc28gYSBHRU5FUkFMIGNhdGVnb3J5IHRoYXQgZXhpc3RzIG1haW5seSBmb3IgZnV0dXJlIHByb29maW5nLiBBZGRpdGlvbmFsIGV2ZW50cyBtYXkgYmUgY29uZmlndXJlZCBpbiB0aGUgZnV0dXJlLlxuICAgKiBAcGFyYW0ge0d3Tm90aWZpY2F0aW9uVHlwZX0gbm90aWZpY2F0aW9uVHlwZVxuICAgKiBAcGFyYW0ge0d3Tm90aWZpY2F0aW9uQ2FsbGJhY2t9IGNhbGxiYWNrXG4gICAqL1xuICBzdGF0aWMgcmVtb3ZlQ2FsbGJhY2tGb3JHd05vdGlmaWNhdGlvblR5cGUobm90aWZpY2F0aW9uVHlwZTogR3dOb3RpZmljYXRpb25UeXBlKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmd3Tm90aWZpY2F0aW9uTGlzdGVuZXJzW25vdGlmaWNhdGlvblR5cGVdKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJBdHRlbXB0aW5nIHRvIHJlbW92ZSBhIG5vbiBleGlzdGVudCBub3RpZmljYXRpb24gbGlzdGVuZXIgZm9yOiBcIiArIG5vdGlmaWNhdGlvblR5cGUpO1xuICAgIH1cbiAgICBkZWxldGUgdGhpcy5nd05vdGlmaWNhdGlvbkxpc3RlbmVyc1tub3RpZmljYXRpb25UeXBlXTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsImEiLCJpIiwic2VsZiIsIkd3TWVzc2FnZXNUb0dXIiwiR3dNZXNzYWdlc0Zyb21HVyIsIkd3Tm90aWZpY2F0aW9uVHlwZSIsIkd3TWVzc2FnZVN0YXR1cyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwiR3dDcm9zc09yaWdpbkV4dGVybmFsIiwic3RhdGljIiwiRXJyb3IiLCJpbml0Iiwib3JpZ2luRm9yR3dBcHAiLCJhbGxvd0xpc3RlZERvbWFpbnMiLCJmb3JjZWRPd25lcldpbmRvdyIsInRoaXMiLCJvd25lcldpbmRvdyIsIndpbmRvdyIsInBhcmVudCIsImluaXRpYWxpemVkIiwibWVzc2FnZUV2ZW50TGlzdGVuZXIiLCJyZWNlaXZlTWVzc2FnZUZyb21Hd0FwcCIsImJpbmQiLCJhZGRFdmVudExpc3RlbmVyIiwiaXNJbml0aWFsaXplZCIsImtpbGwiLCJ1bmRlZmluZWQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwidGhyb3dJZlVudHJ1c3RlZE9yaWdpbiIsImV2ZW50Iiwic291cmNlIiwib3JpZ2luIiwiZGF0YSIsImd3Tm9uR3dPcmlnaW5JZkFueSIsImd3TWVzc2FnZVR5cGUiLCJWQUxVRVMiLCJyZWNlaXZlVmFsdWVzTWVzc2FnZSIsIlJFU1BPTlNFX0ZST01fTk9OX0JMT0NLSU5HX1NFUlZFUl9SRVFVRVNUIiwicmVjZWl2ZU5vbkJsb2NraW5nU2VydmVyUmVxdWVzdFJlcG9uc2VNZXNzYWdlIiwiQ09ORklSTUFUSU9OX09OTFkiLCJyZWNlaXZlQ29uZmlybWF0aW9uT25seU1lc3NhZ2UiLCJSRUNFSVZFX0NST1NTX09SSUdJTl9FVkVOVCIsInJlY2VpdmVDcm9zc09yaWdpbkV2ZW50IiwiUkVDRUlWRV9HV19OT1RJRklDQVRJT04iLCJyZWNlaXZlR3dOb3RpZmljYXRpb24iLCJyZWNlaXZlTm9uQ29uZm9ybWluZ01lc3NhZ2VUeXBlRnJvbUd3QXBwIiwiZ2V0QXdhaXRpbmdJbmZvRm9yQ29ycmVzcG9uZGluZ01lc3NhZ2VEYXRhIiwicmVzcG9uc2VUb01lc3NhZ2VJZCIsImd3UmVzcG9uc2VUb01lc3NhZ2VJZCIsImNvbnNvbGUiLCJlcnJvciIsImluZm8iLCJtZXNzYWdlc0F3YWl0aW5nUmVzcG9uc2UiLCJHd1Rlc3RFbnYiLCJyZWNlaXZlTWVzc2FnZSIsInBheWxvYWQiLCJnd1BheWxvYWQiLCJzdGF0dXMiLCJnd1N0YXR1cyIsImNhbGxiYWNrIiwiRkFJTEVEIiwicmVqZWN0IiwiZnVsZmlsbCIsImV2IiwiZXZlbnRzIiwiY3Jvc3NPcmlnaW5FdmVudENhbGxiYWNrQnlCcm9hZGNhc3RlclRoZW5FdmVudCIsImJyb2FkY2FzdGVyV2luZG93SWQiLCJ3YXJuIiwiZXZlbnRMaXN0ZW5lckNhbGxiYWNrIiwiZXZlbnROYW1lIiwibm90aWZpY2F0aW9uIiwiZ3dOb3RpZmljYXRpb25MaXN0ZW5lcnMiLCJ0eXBlIiwicG9zc2libGVDdXN0b21NZXRob2ROYW1lIiwic2VuZE1lc3NhZ2UiLCJtZXNzYWdlVHlwZSIsIlByb21pc2UiLCJtZXNzYWdlSWQiLCJuZXh0TWVzc2FnZUlkIiwiUEVORElORyIsImd3TWVzc2FnZUlkIiwibWVzc2FnZUF3YWl0aW5nUmVzcG9uc2UiLCJ0aW1lc3RhbXAiLCJwZXJmb3JtYW5jZSIsIm5vdyIsInByb21pc2UiLCJwb3N0TWVzc2FnZSIsImUiLCJzZXRWYWx1ZXMiLCJsb2dpY2FsTmFtZVRvVmFsdWVNYXAiLCJTRVRfVkFMVUVTIiwiZ2V0VmFsdWVzIiwibG9naWNhbE5hbWVzIiwiR0VUX1ZBTFVFUyIsImZpcmVBY3Rpb25PblNlcnZlciIsIkZJUkVfQUNUSU9OIiwibWFrZU5vbkJsb2NraW5nU2VydmVyUmVxdWVzdCIsIk5PTl9CTE9DS0lOR19TRVJWRVJfUkVRVUVTVCIsImFkZENyb3NzT3JpZ2luRXZlbnRMaXN0ZW5lciIsImJyb2FkY2FzdGVyV2luZG93TmFtZSIsImN1cnJlbnRseUxpc3RlbmVkVG9FdmVudHMiLCJrZXlzIiwibGVuZ3RoIiwiQUREX0NST1NTX09SSUdJTl9FVkVOVF9MSVNURU5FUiIsInJlbW92ZUNyb3NzT3JpZ2luRXZlbnRMaXN0ZW5lciIsImJ5QnJvYWRjYXN0ZXIiLCJSRU1PVkVfQ1JPU1NfT1JJR0lOX0VWRU5UX0xJU1RFTkVSIiwiYnJvYWRjYXN0Q3Jvc3NPcmlnaW5FdmVudCIsIkJST0FEQ0FTVF9DUk9TU19PUklHSU5fRVZFTlQiLCJhZGRDYWxsYmFja0Zvckd3Tm90aWZpY2F0aW9uVHlwZSIsIm5vdGlmaWNhdGlvblR5cGUiLCJyZW1vdmVDYWxsYmFja0Zvckd3Tm90aWZpY2F0aW9uVHlwZSJdLCJzb3VyY2VSb290IjoiIn0=