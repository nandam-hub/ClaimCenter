<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) -->
<title>Transaction (Guidewire Java API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: gw.transaction, class: Transaction">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
<script type="text/javascript" src="../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li><a href="#nested-class-summary">Nested</a></li>
<li>Field</li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">gw.transaction</a></div>
<h1 title="Class Transaction" class="title">Class Transaction</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">gw.transaction.Transaction</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">Transaction</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">Helper class used to get the current transaction bundle or to start a new bundle transaction.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="Transaction.BlockRunnable.html" class="type-name-link" title="interface in gw.transaction">Transaction.BlockRunnable</a></code></div>
<div class="col-last even-row-color">
<div class="block">Runnable block of code passed a Bundle.</div>
</div>
<div class="col-first odd-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="Transaction.FunctionWithException.html" class="type-name-link" title="interface in gw.transaction">Transaction.FunctionWithException</a>&lt;<a href="Transaction.FunctionWithException.html" title="type parameter in Transaction.FunctionWithException">T</a>,<wbr><a href="Transaction.FunctionWithException.html" title="type parameter in Transaction.FunctionWithException">R</a>&gt;</code></div>
<div class="col-last odd-row-color">
<div class="block">A Function that accepts a T and returns a R, except that the apply
 method may throw an Exception</div>
</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="Transaction.RunnableWithException.html" class="type-name-link" title="interface in gw.transaction">Transaction.RunnableWithException</a></code></div>
<div class="col-last even-row-color">
<div class="block">A runnable block of code that can throw an Exception</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">Transaction</a>()</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;T&gt;&nbsp;T</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#asUserOnlyApply(entity.User,gw.transaction.Transaction.FunctionWithException,java.util.function.Function)" class="member-name-link">asUserOnlyApply</a><wbr>(@NotNull <a href="../../entity/User.html" title="class in entity">User</a>&nbsp;user,
 @NotNull <a href="Transaction.FunctionWithException.html" title="interface in gw.transaction">Transaction.FunctionWithException</a>&lt;<a href="../pl/persistence/core/Bundle.html" title="interface in gw.pl.persistence.core">Bundle</a>,<wbr>T&gt;&nbsp;block,
 @Nullable <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a>,<wbr>T&gt;&nbsp;onException)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Executes the block as the given user, it will also create the bundle for the given user,
 but this does NOT call commit.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#asUserOnlyExecute(entity.User,gw.transaction.Transaction.RunnableWithException)" class="member-name-link">asUserOnlyExecute</a><wbr>(@NotNull <a href="../../entity/User.html" title="class in entity">User</a>&nbsp;user,
 @NotNull <a href="Transaction.RunnableWithException.html" title="interface in gw.transaction">Transaction.RunnableWithException</a>&nbsp;block)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Execute the given block as the given user.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#clearThreadsBundle()" class="member-name-link">clearThreadsBundle</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">This clears the thread's bundle.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="PublicServiceToken.html" title="interface in gw.transaction">PublicServiceToken</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#createAuthenticatedToken(gw.pl.persistence.core.Key)" class="member-name-link">createAuthenticatedToken</a><wbr>(<a href="../pl/persistence/core/Key.html" title="class in gw.pl.persistence.core">Key</a>&nbsp;userId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">This will create a new authenticated service token for the supplied user.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../pl/persistence/core/Bundle.html" title="interface in gw.pl.persistence.core">Bundle</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#getCurrent()" class="member-name-link">getCurrent</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns the current transaction bundle.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="PublicServiceToken.html" title="interface in gw.transaction">PublicServiceToken</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#getCurrentServiceToken()" class="member-name-link">getCurrentServiceToken</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">This will get the current service token.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../pl/persistence/core/Bundle.html" title="interface in gw.pl.persistence.core">Bundle</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#newBundle()" class="member-name-link">newBundle</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Creates a new entity bundle.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="../pl/persistence/core/Bundle.html" title="interface in gw.pl.persistence.core">Bundle</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#newNonPersistableBundle()" class="member-name-link">newNonPersistableBundle</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns bundle that cannot be committed.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#runWithNewBundle(gw.transaction.Transaction.BlockRunnable)" class="member-name-link">runWithNewBundle</a><wbr>(<a href="Transaction.BlockRunnable.html" title="interface in gw.transaction">Transaction.BlockRunnable</a>&nbsp;block)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Runs the specified block using a new bundle.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#runWithNewBundle(gw.transaction.Transaction.BlockRunnable,entity.User)" class="member-name-link">runWithNewBundle</a><wbr>(<a href="Transaction.BlockRunnable.html" title="interface in gw.transaction">Transaction.BlockRunnable</a>&nbsp;block,
 <a href="../../entity/User.html" title="class in entity">User</a>&nbsp;user)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Runs the specified block using a new bundle with the given user set as the active user.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#runWithNewBundle(gw.transaction.Transaction.BlockRunnable,java.lang.String)" class="member-name-link">runWithNewBundle</a><wbr>(<a href="Transaction.BlockRunnable.html" title="interface in gw.transaction">Transaction.BlockRunnable</a>&nbsp;block,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;username)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Runs the specified block using a new bundle with the user identified by the given username set as the active user.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="ResourceAutoCloseable.html" title="interface in gw.transaction">ResourceAutoCloseable</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#setServiceToken(gw.transaction.PublicServiceToken)" class="member-name-link">setServiceToken</a><wbr>(<a href="PublicServiceToken.html" title="interface in gw.transaction">PublicServiceToken</a>&nbsp;token)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">This will set the service token.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="ResourceAutoCloseable.html" title="interface in gw.transaction">ResourceAutoCloseable</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#setThreadsBundle(gw.pl.persistence.core.BundleProvider)" class="member-name-link">setThreadsBundle</a><wbr>(<a href="../pl/persistence/core/BundleProvider.html" title="interface in gw.pl.persistence.core">BundleProvider</a>&nbsp;bundle)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">This sets the thread into the bundle and returns a method to clear when finished.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>Transaction</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">Transaction</span>()</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="getCurrent()">
<h3>getCurrent</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../pl/persistence/core/Bundle.html" title="interface in gw.pl.persistence.core">Bundle</a></span>&nbsp;<span class="element-name">getCurrent</span>()</div>
<div class="block">Returns the current transaction bundle.  If the current transaction isn't set then null is returned.
 <p/>
 Many execution contexts contain a default bundle (PCF files, non-validation rules, background processes, web services, etc...).</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the current bundle</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getCurrentServiceToken()">
<h3>getCurrentServiceToken</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="PublicServiceToken.html" title="interface in gw.transaction">PublicServiceToken</a></span>&nbsp;<span class="element-name">getCurrentServiceToken</span>()</div>
<div class="block">This will get the current service token.  This is added for some unusual patterns used in the
 apps.  Normally it is preferred that customers use runWithNewBundle, because that method
 does the set; execute; commit; and follows up with the reset. Otherwise it is the reset is the
 callers responsibility.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the public accessible service token</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="createAuthenticatedToken(gw.pl.persistence.core.Key)">
<h3>createAuthenticatedToken</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="PublicServiceToken.html" title="interface in gw.transaction">PublicServiceToken</a></span>&nbsp;<span class="element-name">createAuthenticatedToken</span><wbr><span class="parameters">(<a href="../pl/persistence/core/Key.html" title="class in gw.pl.persistence.core">Key</a>&nbsp;userId)</span></div>
<div class="block">This will create a new authenticated service token for the supplied user.  This does NOT set this
 newly created service token as the current token. This is added for some unusual patterns used in the
 apps.  Normally it is preferred that customers use runWithNewBundle, because that method
 does the set; execute; commit; and follows up with the reset. Otherwise it is the reset is the
 callers responsibility.

 As there is already a service token for the current user, this typically is set to User.util.UnrestrictedUser,
 <a href="../api/community/PublicUserUtil.html#getUnrestrictedUser()"><code>PublicUserUtil.getUnrestrictedUser()</code></a>
 or app/customer specific specialty user.

 This is provided for some unique usage patterns, normally the entire pattern is executed
 via <a href="#runWithNewBundle(gw.transaction.Transaction.BlockRunnable,entity.User)"><code>runWithNewBundle(gw.transaction.Transaction.BlockRunnable, entity.User)</code></a></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>a service token</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setServiceToken(gw.transaction.PublicServiceToken)">
<h3>setServiceToken</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="ResourceAutoCloseable.html" title="interface in gw.transaction">ResourceAutoCloseable</a></span>&nbsp;<span class="element-name">setServiceToken</span><wbr><span class="parameters">(<a href="PublicServiceToken.html" title="interface in gw.transaction">PublicServiceToken</a>&nbsp;token)</span></div>
<div class="block">This will set the service token.  This is added for some unusual patterns used n the apps.
 Normally it is preferred that customers use runWithNewBundle, because that method
 does the set; execute; commit; and follows up with the reset.  This method returns an
 auto closeable object, that will reset the service token.  This can be use in a try with
 resources statement, otherwise, it is still the caller's responsibility to restore the
 the service token.

 Note that this returns an <a href="ResourceAutoCloseable.html" title="interface in gw.transaction"><code>ResourceAutoCloseable</code></a> which can be used in either try with
 resource in java or "using" block in gosu.

 For example:
 * <pre>
 * <code>
      var suUser = User.util.UnrestrictedUser
      using(var ignore = Transaction.setServiceToken(Transaction.createAuthenticatedToken(suUser.ID)) {
      }
 * </code>
 * </pre>

 This is usually called with the object created by <a href="#createAuthenticatedToken(gw.pl.persistence.core.Key)"><code>createAuthenticatedToken(gw.pl.persistence.core.Key)</code></a>

 This is provided for some unique usage patterns, normally the entire pattern is executed
 via <a href="#runWithNewBundle(gw.transaction.Transaction.BlockRunnable,entity.User)"><code>runWithNewBundle(gw.transaction.Transaction.BlockRunnable, entity.User)</code></a></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>token</code> - the new token</dd>
<dt>Returns:</dt>
<dd>an auto closeable block that does not throw</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="runWithNewBundle(gw.transaction.Transaction.BlockRunnable)">
<h3>runWithNewBundle</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">runWithNewBundle</span><wbr><span class="parameters">(<a href="Transaction.BlockRunnable.html" title="interface in gw.transaction">Transaction.BlockRunnable</a>&nbsp;block)</span></div>
<div class="block">Runs the specified block using a new bundle.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>block</code> - the block to run</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if there isn't an active user</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="runWithNewBundle(gw.transaction.Transaction.BlockRunnable,entity.User)">
<h3>runWithNewBundle</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">runWithNewBundle</span><wbr><span class="parameters">(<a href="Transaction.BlockRunnable.html" title="interface in gw.transaction">Transaction.BlockRunnable</a>&nbsp;block,
 <a href="../../entity/User.html" title="class in entity">User</a>&nbsp;user)</span></div>
<div class="block">Runs the specified block using a new bundle with the given user set as the active user.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>block</code> - the block to run</dd>
<dd><code>user</code> - the user to run as</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="runWithNewBundle(gw.transaction.Transaction.BlockRunnable,java.lang.String)">
<h3>runWithNewBundle</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">runWithNewBundle</span><wbr><span class="parameters">(<a href="Transaction.BlockRunnable.html" title="interface in gw.transaction">Transaction.BlockRunnable</a>&nbsp;block,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;username)</span></div>
<div class="block">Runs the specified block using a new bundle with the user identified by the given username set as the active user.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>block</code> - the block to run</dd>
<dd><code>username</code> - the username to run as</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if no user with the given username is found</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="newBundle()">
<h3>newBundle</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../pl/persistence/core/Bundle.html" title="interface in gw.pl.persistence.core">Bundle</a></span>&nbsp;<span class="element-name">newBundle</span>()</div>
<div class="block">Creates a new entity bundle. This is an alternative to
 <a href="#runWithNewBundle(gw.transaction.Transaction.BlockRunnable)"><code>runWithNewBundle(gw.transaction.Transaction.BlockRunnable)</code></a> for cases when the caller needs more control
 over when, if ever, the bundle is committed.

 This is provided for some unique usage patterns, normally the entire pattern is executed
 via <a href="#runWithNewBundle(gw.transaction.Transaction.BlockRunnable)"><code>runWithNewBundle(gw.transaction.Transaction.BlockRunnable)</code></a> or <a href="#asUserOnlyExecute(entity.User,gw.transaction.Transaction.RunnableWithException)"><code>asUserOnlyExecute(User, RunnableWithException)</code></a>

 After the bundle is created, you usually set it in thread, and once you are done you want to clear it.
 For example:
 * <pre>
 * <code>
      var bundle = Transaction.newBundle()
      try {
        Transaction.setThreadsBundle(bundle)
        ...
      } finally {
        transaction.clearThreadsBundle()
      }
 * </code>
 * </pre></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>a new bundle</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="newNonPersistableBundle()">
<h3>newNonPersistableBundle</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="../pl/persistence/core/Bundle.html" title="interface in gw.pl.persistence.core">Bundle</a></span>&nbsp;<span class="element-name">newNonPersistableBundle</span>()</div>
<div class="block">Returns bundle that cannot be committed. This bundle can be used to create temporary beans, and
 be passed to routines that expect a bundle, but you want to be sure that the bundle is never committed. Beans
 created in this bundle do not consume generated ids</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>a new bundle that will throw an exception if commit is called.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setThreadsBundle(gw.pl.persistence.core.BundleProvider)">
<h3>setThreadsBundle</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="ResourceAutoCloseable.html" title="interface in gw.transaction">ResourceAutoCloseable</a></span>&nbsp;<span class="element-name">setThreadsBundle</span><wbr><span class="parameters">(<a href="../pl/persistence/core/BundleProvider.html" title="interface in gw.pl.persistence.core">BundleProvider</a>&nbsp;bundle)</span></div>
<div class="block">This sets the thread into the bundle and returns a method to clear when finished.  To clear manually
 call <a href="#clearThreadsBundle()"><code>clearThreadsBundle()</code></a>

 Normally, <a href="#runWithNewBundle(gw.transaction.Transaction.BlockRunnable,entity.User)"><code>runWithNewBundle(BlockRunnable, User)</code></a> is used to encapsulate the entire pattern,
 but under some circumstances more control is desired so this may be call explicitly.

 For example:
 * <pre>
 * <code>
      using (var ignore = Transaction.setThreadsBundle(Transaction.newBundle()) {
         ...
      }
 * </code>
 * </pre>
 or
 * <pre>
 * <code>
      var bundle = Transaction.newBundle()
      try {
        Transaction.setThreadsBundle(bundle)
        ...
      } finally {}
      Transaction.clearThreadsBundle()
 * </code>
 * </pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>bundle</code> - the newBundle to set</dd>
<dt>Returns:</dt>
<dd>an AutoClosable to return the resource</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="clearThreadsBundle()">
<h3>clearThreadsBundle</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">clearThreadsBundle</span>()</div>
<div class="block">This clears the thread's bundle.

 Normally, <a href="#runWithNewBundle(gw.transaction.Transaction.BlockRunnable,entity.User)"><code>runWithNewBundle(BlockRunnable, User)</code></a> is used to encapsulate the entire pattern,
 but under some circumstances more control is desired so this may be call explicitly as part of the pattern.

 For example:
 * <pre>
 * <code>
      var bundle = Transaction.newBundle()
      try {
        Transaction.setThreadsBundle(bundle)
        ...
      } finally {}
      Transaction.clearThreadsBundle()
 * </code>
 * </pre></div>
</section>
</li>
<li>
<section class="detail" id="asUserOnlyExecute(entity.User,gw.transaction.Transaction.RunnableWithException)">
<h3>asUserOnlyExecute</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">asUserOnlyExecute</span><wbr><span class="parameters">(@NotNull
 @NotNull <a href="../../entity/User.html" title="class in entity">User</a>&nbsp;user,
 @NotNull
 @NotNull <a href="Transaction.RunnableWithException.html" title="interface in gw.transaction">Transaction.RunnableWithException</a>&nbsp;block)</span>
                              throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></span></div>
<div class="block">Execute the given block as the given user. The method does NOT create a bundle nor commit any bundle.

 Permits a block to be executed with different permissions than the current user.
 For example if the document permissions are such that the super user cannot
 see sensitive documents, mail transport uses the email creator to retrieve the document
 for sending to the customer.
 Or if the block executes some code that does the commit.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>user</code> - the user to use for execution, example <a href="../api/community/PublicUserUtil.html#getCurrentUser()"><code>PublicUserUtil.getCurrentUser()</code></a> entity.User.util.CurrentUser</dd>
<dd><code>block</code> - the block to execute</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></code> - if the block throws an exception</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="asUserOnlyApply(entity.User,gw.transaction.Transaction.FunctionWithException,java.util.function.Function)">
<h3>asUserOnlyApply</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type">T</span>&nbsp;<span class="element-name">asUserOnlyApply</span><wbr><span class="parameters">(@NotNull
 @NotNull <a href="../../entity/User.html" title="class in entity">User</a>&nbsp;user,
 @NotNull
 @NotNull <a href="Transaction.FunctionWithException.html" title="interface in gw.transaction">Transaction.FunctionWithException</a>&lt;<a href="../pl/persistence/core/Bundle.html" title="interface in gw.pl.persistence.core">Bundle</a>,<wbr>T&gt;&nbsp;block,
 @Nullable
 @Nullable <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a>,<wbr>T&gt;&nbsp;onException)</span>
                             throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></span></div>
<div class="block">Executes the block as the given user, it will also create the bundle for the given user,
 but this does NOT call commit.   The block usually has some call that creates a new bean, performs
 a commit, and then returns the newly created bean.  The common reasons to run with a different user
 than current user is either permissions, the block needs to run as the UnrestrictedUser;
 or tracking -- most background processes execute as the UnrestrictedUser but often the originating user is known
 and we want to use that user for updated beans.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>user</code> - the user to use for these queries, example <a href="../api/community/PublicUserUtil.html#getUnrestrictedUser()"><code>PublicUserUtil.getUnrestrictedUser()</code></a>  } entity.User.util.UnrestrictedUser</dd>
<dd><code>block</code> - the function to execute</dd>
<dd><code>onException</code> - the function to execute if an exception is thrown</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></code> - if the block throws an exception, and onException is null</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><p>Copyright &#169; 2001-2014 Guidewire Software, Inc. All rights reserved.</p><p>Guidewire, Guidewire Software, Guidewire ClaimCenter, Guidewire PolicyCenter, Guidewire BillingCenter, Guidewire Reinsurance Management, Guidewire ContactManager, Guidewire Vendor Data Management, Guidewire Client Data Management, Guidewire Rating Management, Guidewire InsuranceSuite, Guidewire ContactCenter, Guidewire Studio, Guidewire Product Designer, Guidewire Live, Guidewire DataHub, Guidewire InfoCenter, Guidewire Standard Reporting, Guidewire ExampleCenter, Guidewire Account Manager Portal, Guidewire Claim Portal, Guidewire Policyholder Portal, ClaimCenter, BillingCenter, PolicyCenter, InsuranceSuite, Gosu, Deliver Insurance Your Way, and the Guidewire logo are trademarks, service marks, or registered trademarks of Guidewire Software, Inc. in the United States and/or other countries.</p><p>Guidewire, Guidewire Software, Guidewire ClaimCenter, Guidewire PolicyCenter, Guidewire BillingCenter, Guidewire InsuranceSuite, Gosu, Deliver Insurance Your Way, and the Guidewire logo are trademarks, service marks, or registered trademarks of Guidewire Software, Inc. in the United States and/or other countries.</p><p>All other trademarks are the property of their respective owners.</p><p>This material is confidential and proprietary to Guidewire and subject to the confidentiality terms in the applicable license agreement and/or separate nondisclosure agreement.</p><p>Guidewire products are protected by one or more United States patents.</p></small></p>
</footer>
</div>
</div>
</body>
</html>
